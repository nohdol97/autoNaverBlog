# Define the source branch with the changes
$sourceBranch = "infinite"

# Get the list of all branches
$branches = git branch --list | ForEach-Object { $_.Trim() -replace '\* ', '' }

# Get the latest commit hash from the source branch
$latestCommit = git log -n 1 --pretty=format:"%H" $sourceBranch

# Loop through each branch and cherry-pick the changes
foreach ($branch in $branches) {
    if ($branch -ne $sourceBranch) {
        Write-Host "Cherry-picking changes into $branch"
        git checkout $branch
        git cherry-pick $latestCommit
    }
}

# Checkout back to the source branch at the end
git checkout $sourceBranch